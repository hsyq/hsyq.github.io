<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>经典CRUD | 昆吾-前端知识分享</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?562e4deb07df6b3921feca881c66f20a";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();
      </script>
    <meta name="description" content="前端技术博客，分享前端学习路上的资料。专注web前端开发、前端工程化，做最有价值的前端技术学习网站。">
    <meta name="keywords" content="前端知识分享">
    <meta name="baidu-site-verification" content="code-WKuN3yvILD">
    
    <link rel="preload" href="/assets/css/0.styles.9825735b.css" as="style"><link rel="preload" href="/assets/js/app.d3443b47.js" as="script"><link rel="preload" href="/assets/js/2.2defd20b.js" as="script"><link rel="preload" href="/assets/js/68.793e626b.js" as="script"><link rel="prefetch" href="/assets/js/10.b1a692f0.js"><link rel="prefetch" href="/assets/js/100.5e5daac4.js"><link rel="prefetch" href="/assets/js/101.bcdd2eaf.js"><link rel="prefetch" href="/assets/js/102.bf6d8db7.js"><link rel="prefetch" href="/assets/js/103.f679ec78.js"><link rel="prefetch" href="/assets/js/104.5dbc3b60.js"><link rel="prefetch" href="/assets/js/105.569b5e21.js"><link rel="prefetch" href="/assets/js/106.c21ea00c.js"><link rel="prefetch" href="/assets/js/107.c5fcb7dc.js"><link rel="prefetch" href="/assets/js/11.712543aa.js"><link rel="prefetch" href="/assets/js/12.07545aec.js"><link rel="prefetch" href="/assets/js/13.eded5389.js"><link rel="prefetch" href="/assets/js/14.2a03286e.js"><link rel="prefetch" href="/assets/js/15.baaf6314.js"><link rel="prefetch" href="/assets/js/16.cb6d64db.js"><link rel="prefetch" href="/assets/js/17.298e8619.js"><link rel="prefetch" href="/assets/js/18.bf0c0054.js"><link rel="prefetch" href="/assets/js/19.70617632.js"><link rel="prefetch" href="/assets/js/20.022b748c.js"><link rel="prefetch" href="/assets/js/21.deae6af8.js"><link rel="prefetch" href="/assets/js/22.7aaf15ce.js"><link rel="prefetch" href="/assets/js/23.4ede9dcc.js"><link rel="prefetch" href="/assets/js/24.7782803f.js"><link rel="prefetch" href="/assets/js/25.67a79e43.js"><link rel="prefetch" href="/assets/js/26.716262c8.js"><link rel="prefetch" href="/assets/js/27.f13f1b2d.js"><link rel="prefetch" href="/assets/js/28.431cb40a.js"><link rel="prefetch" href="/assets/js/29.57b1086d.js"><link rel="prefetch" href="/assets/js/3.3c08d9fd.js"><link rel="prefetch" href="/assets/js/30.9b94ef43.js"><link rel="prefetch" href="/assets/js/31.6fa6655b.js"><link rel="prefetch" href="/assets/js/32.a0c721ed.js"><link rel="prefetch" href="/assets/js/33.deae6c7d.js"><link rel="prefetch" href="/assets/js/34.c3262e70.js"><link rel="prefetch" href="/assets/js/35.3cd476b1.js"><link rel="prefetch" href="/assets/js/36.67aa9bc8.js"><link rel="prefetch" href="/assets/js/37.f5f91054.js"><link rel="prefetch" href="/assets/js/38.f0591ea9.js"><link rel="prefetch" href="/assets/js/39.c2ea847d.js"><link rel="prefetch" href="/assets/js/4.26f73e91.js"><link rel="prefetch" href="/assets/js/40.5812c8db.js"><link rel="prefetch" href="/assets/js/41.78cdf08a.js"><link rel="prefetch" href="/assets/js/42.d3e481d1.js"><link rel="prefetch" href="/assets/js/43.4193a6fb.js"><link rel="prefetch" href="/assets/js/44.90b96750.js"><link rel="prefetch" href="/assets/js/45.e52ffc4a.js"><link rel="prefetch" href="/assets/js/46.340a61b2.js"><link rel="prefetch" href="/assets/js/47.1b180354.js"><link rel="prefetch" href="/assets/js/48.0e87e39e.js"><link rel="prefetch" href="/assets/js/49.afb5a52b.js"><link rel="prefetch" href="/assets/js/5.5dcec586.js"><link rel="prefetch" href="/assets/js/50.43c6b09f.js"><link rel="prefetch" href="/assets/js/51.6901b68c.js"><link rel="prefetch" href="/assets/js/52.2e6eea10.js"><link rel="prefetch" href="/assets/js/53.5b1457af.js"><link rel="prefetch" href="/assets/js/54.52f5c266.js"><link rel="prefetch" href="/assets/js/55.129298b1.js"><link rel="prefetch" href="/assets/js/56.5f30638e.js"><link rel="prefetch" href="/assets/js/57.f6e29bef.js"><link rel="prefetch" href="/assets/js/58.75cd2758.js"><link rel="prefetch" href="/assets/js/59.946d7dde.js"><link rel="prefetch" href="/assets/js/6.f2a96706.js"><link rel="prefetch" href="/assets/js/60.0f8e83ac.js"><link rel="prefetch" href="/assets/js/61.cce82fd3.js"><link rel="prefetch" href="/assets/js/62.61520a73.js"><link rel="prefetch" href="/assets/js/63.0c4bd376.js"><link rel="prefetch" href="/assets/js/64.6a34c0f5.js"><link rel="prefetch" href="/assets/js/65.513805c2.js"><link rel="prefetch" href="/assets/js/66.8e1e51a0.js"><link rel="prefetch" href="/assets/js/67.4c752c3b.js"><link rel="prefetch" href="/assets/js/69.c0304c26.js"><link rel="prefetch" href="/assets/js/7.1e9c205c.js"><link rel="prefetch" href="/assets/js/70.c3ad0548.js"><link rel="prefetch" href="/assets/js/71.d2138d44.js"><link rel="prefetch" href="/assets/js/72.befc8c7f.js"><link rel="prefetch" href="/assets/js/73.83d5fdfb.js"><link rel="prefetch" href="/assets/js/74.c8301e06.js"><link rel="prefetch" href="/assets/js/75.bf597678.js"><link rel="prefetch" href="/assets/js/76.3a541aec.js"><link rel="prefetch" href="/assets/js/77.52cf55fa.js"><link rel="prefetch" href="/assets/js/78.f70d34ec.js"><link rel="prefetch" href="/assets/js/79.f3adebc9.js"><link rel="prefetch" href="/assets/js/8.95618c99.js"><link rel="prefetch" href="/assets/js/80.a5c79556.js"><link rel="prefetch" href="/assets/js/81.11bc521f.js"><link rel="prefetch" href="/assets/js/82.d834f318.js"><link rel="prefetch" href="/assets/js/83.cd7872bf.js"><link rel="prefetch" href="/assets/js/84.d834b1b5.js"><link rel="prefetch" href="/assets/js/85.8e930ea1.js"><link rel="prefetch" href="/assets/js/86.76298752.js"><link rel="prefetch" href="/assets/js/87.c7b6cfdd.js"><link rel="prefetch" href="/assets/js/88.1977b320.js"><link rel="prefetch" href="/assets/js/89.e7ca179d.js"><link rel="prefetch" href="/assets/js/9.ca7dff0d.js"><link rel="prefetch" href="/assets/js/90.4b23dde7.js"><link rel="prefetch" href="/assets/js/91.c7a3787a.js"><link rel="prefetch" href="/assets/js/92.360d98f4.js"><link rel="prefetch" href="/assets/js/93.1194418f.js"><link rel="prefetch" href="/assets/js/94.72b46403.js"><link rel="prefetch" href="/assets/js/95.748ca6a8.js"><link rel="prefetch" href="/assets/js/96.e15a0042.js"><link rel="prefetch" href="/assets/js/97.f5f39eb9.js"><link rel="prefetch" href="/assets/js/98.6c169af7.js"><link rel="prefetch" href="/assets/js/99.18e02b0e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9825735b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/hero.webp" alt="昆吾-前端知识分享" class="logo"> <span class="site-name can-hide">昆吾-前端知识分享</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/book/" class="nav-link">
  书单
</a></div><div class="nav-item"><a href="/devtool/" class="nav-link">
  工具
</a></div><div class="nav-item"><a href="/engineering/" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><a href="/docker/" class="nav-link">
  Docker
</a></div><div class="nav-item"><a href="/vue3/" class="nav-link">
  Vue3
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><span class="title">Node</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node" class="mobile-dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/koa/" class="nav-link">
  Koa.js
</a></li><li class="dropdown-item"><!----> <a href="/nest/" class="nav-link">
  Nest.js
</a></li><li class="dropdown-item"><h4>
          开发案例
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/demo/" class="nav-link">
  接口服务器案例
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/mongodb/" class="nav-link router-link-active">
  MongoDB
</a></li><li class="dropdown-item"><!----> <a href="/redis/" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><a href="/fe-interview/" class="nav-link">
  前端面试
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档" class="dropdown-title"><span class="title">文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="文档" class="mobile-dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/pm2/" class="nav-link">
  PM2
</a></li><li class="dropdown-item"><!----> <a href="/docs/log4js/" class="nav-link">
  Log4js
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博客" class="dropdown-title"><span class="title">博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="博客" class="mobile-dropdown-title"><span class="title">博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/hsyq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.yuque.com/kunwu-mi1a0" target="_blank" rel="noopener noreferrer" class="nav-link external">
  语雀
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2467751560226270/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/hsyq/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看仓库
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/book/" class="nav-link">
  书单
</a></div><div class="nav-item"><a href="/devtool/" class="nav-link">
  工具
</a></div><div class="nav-item"><a href="/engineering/" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><a href="/docker/" class="nav-link">
  Docker
</a></div><div class="nav-item"><a href="/vue3/" class="nav-link">
  Vue3
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><span class="title">Node</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node" class="mobile-dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/koa/" class="nav-link">
  Koa.js
</a></li><li class="dropdown-item"><!----> <a href="/nest/" class="nav-link">
  Nest.js
</a></li><li class="dropdown-item"><h4>
          开发案例
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/demo/" class="nav-link">
  接口服务器案例
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/mongodb/" class="nav-link router-link-active">
  MongoDB
</a></li><li class="dropdown-item"><!----> <a href="/redis/" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><a href="/fe-interview/" class="nav-link">
  前端面试
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档" class="dropdown-title"><span class="title">文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="文档" class="mobile-dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/pm2/" class="nav-link">
  PM2
</a></li><li class="dropdown-item"><!----> <a href="/docs/log4js/" class="nav-link">
  Log4js
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博客" class="dropdown-title"><span class="title">博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="博客" class="mobile-dropdown-title"><span class="title">博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/hsyq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.yuque.com/kunwu-mi1a0" target="_blank" rel="noopener noreferrer" class="nav-link external">
  语雀
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2467751560226270/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/hsyq/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看仓库
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="经典crud"><a href="#经典crud" class="header-anchor">#</a> 经典CRUD</h1> <h2 id="查询"><a href="#查询" class="header-anchor">#</a> 查询</h2> <h3 id="api"><a href="#api" class="header-anchor">#</a> API</h3> <ul><li><p><a href="https://mongoosejs.com/docs/api/model.html#model_Model.find" target="_blank" rel="noopener noreferrer">Model.find()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://mongoosejs.com/docs/api/model.html#model_Model.findById" target="_blank" rel="noopener noreferrer">Model.findById()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://mongoosejs.com/docs/api/model.html#model_Model.findByIdAndDelete" target="_blank" rel="noopener noreferrer">Model.findByIdAndDelete()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://mongoosejs.com/docs/api/model.html#model_Model.findByIdAndRemove" target="_blank" rel="noopener noreferrer">Model.findByIdAndRemove()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://mongoosejs.com/docs/api/model.html#model_Model.findByIdAndUpdate" target="_blank" rel="noopener noreferrer">Model.findByIdAndUpdate()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://mongoosejs.com/docs/api/model.html#model_Model.findOne" target="_blank" rel="noopener noreferrer">Model.findOne()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://mongoosejs.com/docs/api/model.html#model_Model.findOneAndDelete" target="_blank" rel="noopener noreferrer">Model.findOneAndDelete()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://mongoosejs.com/docs/api/model.html#model_Model.findOneAndRemove" target="_blank" rel="noopener noreferrer">Model.findOneAndRemove()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://mongoosejs.com/docs/api/model.html#model_Model.findOneAndReplace" target="_blank" rel="noopener noreferrer">Model.findOneAndReplace()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://mongoosejs.com/docs/api/model.html#model_Model.findOneAndUpdate" target="_blank" rel="noopener noreferrer">Model.findOneAndUpdate()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://mongoosejs.com/docs/api/model.html#model_Model.hydrate" target="_blank" rel="noopener noreferrer">Model.hydrate()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://mongoosejs.com/docs/api/model.html#model_Model.populate" target="_blank" rel="noopener noreferrer">Model.populate()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul> <h3 id="model-findbyidandupdate"><a href="#model-findbyidandupdate" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#model_Model.findByIdAndUpdate" target="_blank" rel="noopener noreferrer">Model.findByIdAndUpdate()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <h5 id="parameters"><a href="#parameters" class="header-anchor">#</a> Parameters</h5> <ul><li><p>id</p> <p>«Object|Number|String»</p> <p>value of</p> <div class="language- extra-class"><pre class="language-text"><code>_id
</code></pre></div><p>to query by</p></li> <li><p>[update] «Object»</p></li> <li><p>[options]</p> <p>«Object»</p> <p>optional see</p> <p><code>Query.prototype.setOptions()</code></p></li> <li><ul><li><p>[options.returnDocument='before']</p> <p>«String»</p> <p>Has two possible values,</p> <div class="language- extra-class"><pre class="language-text"><code>'before'
</code></pre></div><p>and</p> <div class="language- extra-class"><pre class="language-text"><code>'after'
</code></pre></div><p>. By default, it will return the document before the update was applied.</p></li></ul></li> <li><ul><li><p>[options.lean]</p> <p>«Object»</p> <p>if truthy, mongoose will return the document as a plain JavaScript object rather than a mongoose document. See</p> <p><code>Query.lean()</code></p> <p>and</p> <p>the Mongoose lean tutorial</p> <p>.</p></li></ul></li> <li><ul><li><p>[options.session=null]</p> <p>«ClientSession»</p> <p>The session associated with this query. See</p> <p>transactions docs</p> <p>.</p></li></ul></li> <li><ul><li><p>[options.strict]</p> <p>«Boolean|String»</p> <p>overwrites the schema's</p> <p>strict mode option</p></li></ul></li> <li><ul><li><p>[options.timestamps=null]</p> <p>«Boolean»</p> <p>If set to</p> <div class="language- extra-class"><pre class="language-text"><code>false
</code></pre></div><p>and</p> <p>schema-level timestamps</p> <p>are enabled, skip timestamps for this update. Note that this allows you to overwrite timestamps. Does nothing if schema-level timestamps are not set.</p></li></ul></li> <li><ul><li><p>[options.overwrite=false]</p> <p>«Boolean»</p> <p>By default, if you don't include any</p> <p>update operators</p> <p>in</p> <div class="language- extra-class"><pre class="language-text"><code>update
</code></pre></div><p>, Mongoose will wrap</p> <div class="language- extra-class"><pre class="language-text"><code>update
</code></pre></div><p>in</p> <div class="language- extra-class"><pre class="language-text"><code>$set
</code></pre></div><p>for you. This prevents you from accidentally overwriting the document. This option tells Mongoose to skip adding</p> <div class="language- extra-class"><pre class="language-text"><code>$set
</code></pre></div><p>. An alternative to this would be using</p> <p>Model.findOneAndReplace({ _id: id }, update, options, callback)</p> <p>.</p></li></ul></li> <li><p>[callback] «Function»</p></li></ul> <h5 id="returns"><a href="#returns" class="header-anchor">#</a> Returns:</h5> <ul><li>«Query»</li></ul> <p>通过文档的 _id 字段，发起一个mongodb的查询更新命令。 <code>findByIdAndUpdate(id, ...)</code> 等同于 <code>findOneAndUpdate({ _id: id }, ...)</code>。</p> <p>Issues a mongodb findAndModify update command by a document's _id field. <code>findByIdAndUpdate(id, ...)</code> is equivalent to <code>findOneAndUpdate({ _id: id }, ...)</code>.</p> <p>Finds a matching document, updates it according to the <code>update</code> arg, passing any <code>options</code>, and returns the found document (if any) to the callback. The query executes if <code>callback</code> is passed.</p> <p>This function triggers the following middleware.</p> <ul><li><code>findOneAndUpdate()</code></li></ul> <h4 id="options"><a href="#options" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#options" target="_blank" rel="noopener noreferrer">Options:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <ul><li><code>new</code>: bool - true to return the modified document rather than the original. defaults to false</li> <li><code>upsert</code>: bool - creates the object if it doesn't exist. defaults to false.</li> <li><code>runValidators</code>: if true, runs <a href="https://mongoosejs.com/docs/validation.html#update-validators" target="_blank" rel="noopener noreferrer">update validators<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> on this command. Update validators validate the update operation against the model's schema.</li> <li><code>setDefaultsOnInsert</code>: <code>true</code> by default. If <code>setDefaultsOnInsert</code> and <code>upsert</code> are true, mongoose will apply the <a href="https://mongoosejs.com/docs/defaults.html" target="_blank" rel="noopener noreferrer">defaults<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> specified in the model's schema if a new document is created.</li> <li><code>sort</code>: if multiple docs are found by the conditions, sets the sort order to choose which doc to update</li> <li><code>select</code>: sets the document fields to return</li> <li><code>rawResult</code>: if true, returns the <a href="https://mongodb.github.io/node-mongodb-native/4.3/interfaces/ModifyResult.html" target="_blank" rel="noopener noreferrer">raw result from the MongoDB driver<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>strict</code>: overwrites the schema's <a href="https://mongoosejs.com/docs/guide.html#strict" target="_blank" rel="noopener noreferrer">strict mode option<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for this update</li></ul> <h4 id="examples"><a href="#examples" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#examples" target="_blank" rel="noopener noreferrer">Examples:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>A.findByIdAndUpdate(id, update, options, callback) // executes
A.findByIdAndUpdate(id, update, options)  // returns Query
A.findByIdAndUpdate(id, update, callback) // executes
A.findByIdAndUpdate(id, update)           // returns Query
A.findByIdAndUpdate()                     // returns Query
</code></pre></div><h4 id="note"><a href="#note" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#note" target="_blank" rel="noopener noreferrer">Note:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>All top level update keys which are not <code>atomic</code> operation names are treated as set operations:</p> <h4 id="example"><a href="#example" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#example" target="_blank" rel="noopener noreferrer">Example:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>Model.findByIdAndUpdate(id, { name: 'jason bourne' }, options, callback)

// is sent as
Model.findByIdAndUpdate(id, { $set: { name: 'jason bourne' }}, options, callback)
</code></pre></div><p>This helps prevent accidentally overwriting your document with <code>{ name: 'jason bourne' }</code>.</p> <h4 id="note-2"><a href="#note-2" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#note-1" target="_blank" rel="noopener noreferrer">Note:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p><code>findOneAndX</code> and <code>findByIdAndX</code> functions support limited validation. You can enable validation by setting the <code>runValidators</code> option.</p> <p>If you need full-fledged validation, use the traditional approach of first retrieving the document.</p> <div class="language- extra-class"><pre class="language-text"><code>Model.findById(id, function (err, doc) {
  if (err) ..
  doc.name = 'jason bourne';
  doc.save(callback);
});
</code></pre></div><hr> <h3 id="model-findone"><a href="#model-findone" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#model_Model.findOne" target="_blank" rel="noopener noreferrer">Model.findOne()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <h5 id="parameters-2"><a href="#parameters-2" class="header-anchor">#</a> Parameters</h5> <ul><li><p>[conditions] «Object»</p></li> <li><p>[projection]</p> <p>«Object|String|Array<String>»</String></p> <p>optional fields to return, see</p> <p><code>Query.prototype.select()</code></p></li> <li><p>[options]</p> <p>«Object»</p> <p>optional see</p> <p><code>Query.prototype.setOptions()</code></p></li> <li><p>[callback] «Function»</p></li></ul> <h5 id="returns-2"><a href="#returns-2" class="header-anchor">#</a> Returns:</h5> <ul><li>«Query»</li></ul> <p>Finds one document.</p> <p>The <code>conditions</code> are cast to their respective SchemaTypes before the command is sent.</p> <p><em>Note:</em> <code>conditions</code> is optional, and if <code>conditions</code> is null or undefined, mongoose will send an empty <code>findOne</code> command to MongoDB, which will return an arbitrary document. If you're querying by <code>_id</code>, use <code>findById()</code> instead.</p> <h4 id="example-2"><a href="#example-2" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#example" target="_blank" rel="noopener noreferrer">Example:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>// Find one adventure whose `country` is 'Croatia', otherwise `null`
await Adventure.findOne({ country: 'Croatia' }).exec();

// using callback
Adventure.findOne({ country: 'Croatia' }, function (err, adventure) {});

// select only the adventures name and length
await Adventure.findOne({ country: 'Croatia' }, 'name length').exec();
</code></pre></div><hr> <h3 id="model-findoneanddelete"><a href="#model-findoneanddelete" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#model_Model.findOneAndDelete" target="_blank" rel="noopener noreferrer">Model.findOneAndDelete()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <h5 id="parameters-3"><a href="#parameters-3" class="header-anchor">#</a> Parameters</h5> <ul><li><p>conditions «Object»</p></li> <li><p>[options]</p> <p>«Object»</p> <p>optional see</p> <p><code>Query.prototype.setOptions()</code></p></li> <li><ul><li><p>[options.strict]</p> <p>«Boolean|String»</p> <p>overwrites the schema's</p> <p>strict mode option</p></li></ul></li> <li><ul><li><p>[options.projection=null]</p> <p>«Object|String|Array<String>»</String></p> <p>optional fields to return, see</p> <p><code>Query.prototype.select()</code></p></li></ul></li> <li><ul><li><p>[options.session=null]</p> <p>«ClientSession»</p> <p>The session associated with this query. See</p> <p>transactions docs</p> <p>.</p></li></ul></li> <li><p>[callback] «Function»</p></li></ul> <h5 id="returns-3"><a href="#returns-3" class="header-anchor">#</a> Returns:</h5> <ul><li>«Query»</li></ul> <p>Issue a MongoDB <code>findOneAndDelete()</code> command.</p> <p>Finds a matching document, removes it, and passes the found document (if any) to the callback.</p> <p>Executes the query if <code>callback</code> is passed.</p> <p>This function triggers the following middleware.</p> <ul><li><code>findOneAndDelete()</code></li></ul> <p>This function differs slightly from <code>Model.findOneAndRemove()</code> in that <code>findOneAndRemove()</code> becomes a <a href="https://docs.mongodb.com/manual/reference/method/db.collection.findAndModify/" target="_blank" rel="noopener noreferrer">MongoDB <code>findAndModify()</code> command<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, as opposed to a <code>findOneAndDelete()</code> command. For most mongoose use cases, this distinction is purely pedantic. You should use <code>findOneAndDelete()</code> unless you have a good reason not to.</p> <h4 id="options-2"><a href="#options-2" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#options" target="_blank" rel="noopener noreferrer">Options:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <ul><li><code>sort</code>: if multiple docs are found by the conditions, sets the sort order to choose which doc to update</li> <li><code>maxTimeMS</code>: puts a time limit on the query - requires mongodb &gt;= 2.6.0</li> <li><code>select</code>: sets the document fields to return, ex. <code>{ projection: { _id: 0 } }</code></li> <li><code>projection</code>: equivalent to <code>select</code></li> <li><code>rawResult</code>: if true, returns the <a href="https://mongodb.github.io/node-mongodb-native/4.3/interfaces/ModifyResult.html" target="_blank" rel="noopener noreferrer">raw result from the MongoDB driver<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>strict</code>: overwrites the schema's <a href="https://mongoosejs.com/docs/guide.html#strict" target="_blank" rel="noopener noreferrer">strict mode option<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for this update</li></ul> <h4 id="examples-2"><a href="#examples-2" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#examples" target="_blank" rel="noopener noreferrer">Examples:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>A.findOneAndDelete(conditions, options, callback) // executes
A.findOneAndDelete(conditions, options)  // return Query
A.findOneAndDelete(conditions, callback) // executes
A.findOneAndDelete(conditions) // returns Query
A.findOneAndDelete()           // returns Query
</code></pre></div><p><code>findOneAndX</code> and <code>findByIdAndX</code> functions support limited validation. You can enable validation by setting the <code>runValidators</code> option.</p> <p>If you need full-fledged validation, use the traditional approach of first retrieving the document.</p> <div class="language- extra-class"><pre class="language-text"><code>Model.findById(id, function (err, doc) {
  if (err) ..
  doc.name = 'jason bourne';
  doc.save(callback);
});
</code></pre></div><hr> <h3 id="model-findoneandremove"><a href="#model-findoneandremove" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#model_Model.findOneAndRemove" target="_blank" rel="noopener noreferrer">Model.findOneAndRemove()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <h5 id="parameters-4"><a href="#parameters-4" class="header-anchor">#</a> Parameters</h5> <ul><li><p>conditions «Object»</p></li> <li><p>[options]</p> <p>«Object»</p> <p>optional see</p> <p><code>Query.prototype.setOptions()</code></p></li> <li><ul><li><p>[options.session=null]</p> <p>«ClientSession»</p> <p>The session associated with this query. See</p> <p>transactions docs</p> <p>.</p></li></ul></li> <li><ul><li><p>[options.strict]</p> <p>«Boolean|String»</p> <p>overwrites the schema's</p> <p>strict mode option</p></li></ul></li> <li><ul><li><p>[options.projection=null]</p> <p>«Object|String|Array<String>»</String></p> <p>optional fields to return, see</p> <p><code>Query.prototype.select()</code></p></li></ul></li> <li><p>[callback] «Function»</p></li></ul> <h5 id="returns-4"><a href="#returns-4" class="header-anchor">#</a> Returns:</h5> <ul><li>«Query»</li></ul> <p>Issue a mongodb findAndModify remove command.</p> <p>Finds a matching document, removes it, passing the found document (if any) to the callback.</p> <p>Executes the query if <code>callback</code> is passed.</p> <p>This function triggers the following middleware.</p> <ul><li><code>findOneAndRemove()</code></li></ul> <h4 id="options-3"><a href="#options-3" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#options" target="_blank" rel="noopener noreferrer">Options:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <ul><li><code>sort</code>: if multiple docs are found by the conditions, sets the sort order to choose which doc to update</li> <li><code>maxTimeMS</code>: puts a time limit on the query - requires mongodb &gt;= 2.6.0</li> <li><code>select</code>: sets the document fields to return</li> <li><code>projection</code>: like select, it determines which fields to return, ex. <code>{ projection: { _id: 0 } }</code></li> <li><code>rawResult</code>: if true, returns the <a href="https://mongodb.github.io/node-mongodb-native/4.3/interfaces/ModifyResult.html" target="_blank" rel="noopener noreferrer">raw result from the MongoDB driver<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>strict</code>: overwrites the schema's <a href="https://mongoosejs.com/docs/guide.html#strict" target="_blank" rel="noopener noreferrer">strict mode option<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for this update</li></ul> <h4 id="examples-3"><a href="#examples-3" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#examples" target="_blank" rel="noopener noreferrer">Examples:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>A.findOneAndRemove(conditions, options, callback) // executes
A.findOneAndRemove(conditions, options)  // return Query
A.findOneAndRemove(conditions, callback) // executes
A.findOneAndRemove(conditions) // returns Query
A.findOneAndRemove()           // returns Query
</code></pre></div><p><code>findOneAndX</code> and <code>findByIdAndX</code> functions support limited validation. You can enable validation by setting the <code>runValidators</code> option.</p> <p>If you need full-fledged validation, use the traditional approach of first retrieving the document.</p> <div class="language- extra-class"><pre class="language-text"><code>Model.findById(id, function (err, doc) {
  if (err) ..
  doc.name = 'jason bourne';
  doc.save(callback);
});
</code></pre></div><hr> <h3 id="model-findoneandreplace"><a href="#model-findoneandreplace" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#model_Model.findOneAndReplace" target="_blank" rel="noopener noreferrer">Model.findOneAndReplace()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <h5 id="parameters-5"><a href="#parameters-5" class="header-anchor">#</a> Parameters</h5> <ul><li><p>filter</p> <p>«Object»</p> <p>Replace the first document that matches this filter</p></li> <li><p>[replacement]</p> <p>«Object»</p> <p>Replace with this document</p></li> <li><p>[options]</p> <p>«Object»</p> <p>optional see</p> <p><code>Query.prototype.setOptions()</code></p></li> <li><ul><li><p>[options.returnDocument='before']</p> <p>«String»</p> <p>Has two possible values,</p> <div class="language- extra-class"><pre class="language-text"><code>'before'
</code></pre></div><p>and</p> <div class="language- extra-class"><pre class="language-text"><code>'after'
</code></pre></div><p>. By default, it will return the document before the update was applied.</p></li></ul></li> <li><ul><li><p>[options.lean]</p> <p>«Object»</p> <p>if truthy, mongoose will return the document as a plain JavaScript object rather than a mongoose document. See</p> <p><code>Query.lean()</code></p> <p>and</p> <p>the Mongoose lean tutorial</p> <p>.</p></li></ul></li> <li><ul><li><p>[options.session=null]</p> <p>«ClientSession»</p> <p>The session associated with this query. See</p> <p>transactions docs</p> <p>.</p></li></ul></li> <li><ul><li><p>[options.strict]</p> <p>«Boolean|String»</p> <p>overwrites the schema's</p> <p>strict mode option</p></li></ul></li> <li><ul><li><p>[options.timestamps=null]</p> <p>«Boolean»</p> <p>If set to</p> <div class="language- extra-class"><pre class="language-text"><code>false
</code></pre></div><p>and</p> <p>schema-level timestamps</p> <p>are enabled, skip timestamps for this update. Note that this allows you to overwrite timestamps. Does nothing if schema-level timestamps are not set.</p></li></ul></li> <li><ul><li><p>[options.projection=null]</p> <p>«Object|String|Array<String>»</String></p> <p>optional fields to return, see</p> <p><code>Query.prototype.select()</code></p></li></ul></li> <li><p>[callback] «Function»</p></li></ul> <h5 id="returns-5"><a href="#returns-5" class="header-anchor">#</a> Returns:</h5> <ul><li>«Query»</li></ul> <p>Issue a MongoDB <code>findOneAndReplace()</code> command.</p> <p>Finds a matching document, replaces it with the provided doc, and passes the returned doc to the callback.</p> <p>Executes the query if <code>callback</code> is passed.</p> <p>This function triggers the following query middleware.</p> <ul><li><code>findOneAndReplace()</code></li></ul> <h4 id="options-4"><a href="#options-4" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#options" target="_blank" rel="noopener noreferrer">Options:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <ul><li><code>sort</code>: if multiple docs are found by the conditions, sets the sort order to choose which doc to update</li> <li><code>maxTimeMS</code>: puts a time limit on the query - requires mongodb &gt;= 2.6.0</li> <li><code>select</code>: sets the document fields to return</li> <li><code>projection</code>: like select, it determines which fields to return, ex. <code>{ projection: { _id: 0 } }</code></li> <li><code>rawResult</code>: if true, returns the <a href="https://mongodb.github.io/node-mongodb-native/4.3/interfaces/ModifyResult.html" target="_blank" rel="noopener noreferrer">raw result from the MongoDB driver<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>strict</code>: overwrites the schema's <a href="https://mongoosejs.com/docs/guide.html#strict" target="_blank" rel="noopener noreferrer">strict mode option<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for this update</li></ul> <h4 id="examples-4"><a href="#examples-4" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#examples" target="_blank" rel="noopener noreferrer">Examples:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>A.findOneAndReplace(filter, replacement, options, callback) // executes
A.findOneAndReplace(filter, replacement, options)  // return Query
A.findOneAndReplace(filter, replacement, callback) // executes
A.findOneAndReplace(filter, replacement) // returns Query
A.findOneAndReplace()                    // returns Query
</code></pre></div><hr> <h3 id="model-findoneandupdate"><a href="#model-findoneandupdate" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#model_Model.findOneAndUpdate" target="_blank" rel="noopener noreferrer">Model.findOneAndUpdate()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <h5 id="parameters-6"><a href="#parameters-6" class="header-anchor">#</a> Parameters</h5> <ul><li><p>[conditions] «Object»</p></li> <li><p>[update] «Object»</p></li> <li><p>[options]</p> <p>«Object»</p> <p>optional see</p> <p><code>Query.prototype.setOptions()</code></p></li> <li><ul><li><p>[options.returnDocument='before']</p> <p>«String»</p> <p>Has two possible values,</p> <div class="language- extra-class"><pre class="language-text"><code>'before'
</code></pre></div><p>and</p> <div class="language- extra-class"><pre class="language-text"><code>'after'
</code></pre></div><p>. By default, it will return the document before the update was applied.</p></li></ul></li> <li><ul><li><p>[options.lean]</p> <p>«Object»</p> <p>if truthy, mongoose will return the document as a plain JavaScript object rather than a mongoose document. See</p> <p><code>Query.lean()</code></p> <p>and</p> <p>the Mongoose lean tutorial</p> <p>.</p></li></ul></li> <li><ul><li><p>[options.session=null]</p> <p>«ClientSession»</p> <p>The session associated with this query. See</p> <p>transactions docs</p> <p>.</p></li></ul></li> <li><ul><li><p>[options.strict]</p> <p>«Boolean|String»</p> <p>overwrites the schema's</p> <p>strict mode option</p></li></ul></li> <li><ul><li><p>[options.timestamps=null]</p> <p>«Boolean»</p> <p>If set to</p> <div class="language- extra-class"><pre class="language-text"><code>false
</code></pre></div><p>and</p> <p>schema-level timestamps</p> <p>are enabled, skip timestamps for this update. Note that this allows you to overwrite timestamps. Does nothing if schema-level timestamps are not set.</p></li></ul></li> <li><ul><li><p>[options.overwrite=false]</p> <p>«Boolean»</p> <p>By default, if you don't include any</p> <p>update operators</p> <p>in</p> <div class="language- extra-class"><pre class="language-text"><code>update
</code></pre></div><p>, Mongoose will wrap</p> <div class="language- extra-class"><pre class="language-text"><code>update
</code></pre></div><p>in</p> <div class="language- extra-class"><pre class="language-text"><code>$set
</code></pre></div><p>for you. This prevents you from accidentally overwriting the document. This option tells Mongoose to skip adding</p> <div class="language- extra-class"><pre class="language-text"><code>$set
</code></pre></div><p>. An alternative to this would be using</p> <p>Model.findOneAndReplace(conditions, update, options, callback)</p> <p>.</p></li></ul></li> <li><ul><li><p>[options.upsert=false]</p> <p>«Boolean»</p> <p>if true, and no documents found, insert a new document</p></li></ul></li> <li><ul><li><p>[options.projection=null]</p> <p>«Object|String|Array<String>»</String></p> <p>optional fields to return, see</p> <p><code>Query.prototype.select()</code></p></li></ul></li> <li><p>[callback] «Function»</p></li></ul> <h5 id="returns-6"><a href="#returns-6" class="header-anchor">#</a> Returns:</h5> <ul><li>«Query»</li></ul> <p>Issues a mongodb findAndModify update command.</p> <p>Finds a matching document, updates it according to the <code>update</code> arg, passing any <code>options</code>, and returns the found document (if any) to the callback. The query executes if <code>callback</code> is passed else a Query object is returned.</p> <p>注意，findOneAndUpdate默认返回旧的文档，即查询到的、更新前的文档，</p> <p>通过options.new为true，可以返回更新后的文档。</p> <h4 id="options-5"><a href="#options-5" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#options" target="_blank" rel="noopener noreferrer">Options:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <ul><li><code>new</code>: bool - 如果为true，则返回更新后的文档，否则返回原始文档。默认值为false，在4.0版本变更。（是4.0改为false了还是4.0改为true了？？） defaults to false (changed in 4.0)</li> <li><code>upsert</code>: bool - creates the object if it doesn't exist. defaults to false.</li> <li><code>overwrite</code>: bool - if true, replace the entire document.</li> <li><code>fields</code>: {Object|String} - Field selection. Equivalent to <code>.select(fields).findOneAndUpdate()</code></li> <li><code>maxTimeMS</code>: puts a time limit on the query - requires mongodb &gt;= 2.6.0</li> <li><code>sort</code>: if multiple docs are found by the conditions, sets the sort order to choose which doc to update</li> <li><code>runValidators</code>: if true, runs <a href="https://mongoosejs.com/docs/validation.html#update-validators" target="_blank" rel="noopener noreferrer">update validators<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> on this command. Update validators validate the update operation against the model's schema.</li> <li><code>setDefaultsOnInsert</code>: <code>true</code> by default. If <code>setDefaultsOnInsert</code> and <code>upsert</code> are true, mongoose will apply the <a href="https://mongoosejs.com/docs/defaults.html" target="_blank" rel="noopener noreferrer">defaults<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> specified in the model's schema if a new document is created.</li> <li><code>rawResult</code>: if true, returns the <a href="https://mongodb.github.io/node-mongodb-native/4.3/interfaces/ModifyResult.html" target="_blank" rel="noopener noreferrer">raw result from the MongoDB driver<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>strict</code>: overwrites the schema's <a href="https://mongoosejs.com/docs/guide.html#strict" target="_blank" rel="noopener noreferrer">strict mode option<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for this update</li></ul> <h4 id="examples-5"><a href="#examples-5" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#examples" target="_blank" rel="noopener noreferrer">Examples:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>A.findOneAndUpdate(conditions, update, options, callback) // executes
A.findOneAndUpdate(conditions, update, options)  // returns Query
A.findOneAndUpdate(conditions, update, callback) // executes
A.findOneAndUpdate(conditions, update)           // returns Query
A.findOneAndUpdate()                             // returns Query
</code></pre></div><h4 id="note-3"><a href="#note-3" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#note" target="_blank" rel="noopener noreferrer">Note:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>All top level update keys which are not <code>atomic</code> operation names are treated as set operations:</p> <h4 id="example-3"><a href="#example-3" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#example" target="_blank" rel="noopener noreferrer">Example:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>const query = { name: 'borne' };
Model.findOneAndUpdate(query, { name: 'jason bourne' }, options, callback)

// is sent as
Model.findOneAndUpdate(query, { $set: { name: 'jason bourne' }}, options, callback)
</code></pre></div><p>This helps prevent accidentally overwriting your document with <code>{ name: 'jason bourne' }</code>.</p> <h4 id="note-4"><a href="#note-4" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#note-1" target="_blank" rel="noopener noreferrer">Note:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p><code>findOneAndX</code> and <code>findByIdAndX</code> functions support limited validation that you can enable by setting the <code>runValidators</code> option.</p> <p>If you need full-fledged validation, use the traditional approach of first retrieving the document.</p> <div class="language- extra-class"><pre class="language-text"><code>const doc = await Model.findById(id);
doc.name = 'jason bourne';
await doc.save();
</code></pre></div><p>通过Model查询，得到的结果是一个Query。</p> <p>Model.find()
Parameters：
conditions «Object»
[projection] «Object» optional fields to return (http://bit.ly/1HotzBo)
[options] «Object» optional see Query.prototype.setOptions()
[callback] «Function»</p> <p>Returns: «Query»</p> <p>我们先查询：</p> <p>model.find()</p> <p>再做分页查询：</p> <p>model.find().skip(20).limit(10)</p> <p>再做个排序：</p> <p>model.find().skip(20).limit(10).sort({</p> <p>name: 1</p> <p>})</p> <p>说明，skip，limit，sort方法，是Query的原型方法。</p> <p><strong>Model.find(conditions, [fields], [options], [callback])</strong></p> <p>查询就是返回一个<strong>集合中的文档的子集</strong>，是一个数组。</p> <p>数组的每个元素就是一条文档。</p> <p>conditions <Object> //查询条件</Object></p> <p>[fields] <Object> //要查询的字段</Object></p> <p>[options] <Object> //查询配置参数</Object></p> <p>[callback] <Function> //回调</Function></p> <p>这是18年的叫法。</p> <p>现在文档改了，分别叫做：</p> <p>filter
[projection] optional fields to return, see Query.prototype.select()
[options] «Object» optional see Query.prototype.setOptions()
[callback] «Function»</p> <p>Mongoose Model提供了find，findOne，findBy方法用于文档查询。</p> <p>Model.find()
Model.findById()
Model.findByIdAndDelete()
Model.findByIdAndRemove()
Model.findByIdAndUpdate()
Model.findOne()
Model.findOneAndDelete()
Model.findOneAndRemove()
Model.findOneAndReplace()
Model.findOneAndUpdate()</p> <h3 id="filter"><a href="#filter" class="header-anchor">#</a> filter</h3> <p>«Object|ObjectId»</p> <p>查询条件。是一个对象或者ObjectId。</p> <div class="language-js extra-class"><pre class="language-js"><code>userModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Lee'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

userModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Lee'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">)</span>


userModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$gt</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token literal-property property">$lt</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>


userModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Lee'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span>$<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="范围查询"><a href="#范围查询" class="header-anchor">#</a> 范围查询</h3> <p>$or　　　　或关系</p> <p>$nor　　　 或关系取反</p> <p>$gt　　　　大于</p> <p>$gte　　　 大于等于</p> <p>$lt　　　　 小于</p> <p>$lte　　　  小于等于</p> <p>$ne       不等于</p> <p>$in       在<strong>多个值</strong>范围内（只有一个值时就直接用 {age:10}）</p> <p>$nin      不在多个值范围内</p> <p>$all       匹配数组中多个值</p> <p></p> <p>$size　　　匹配数组大小</p> <p>$maxDistance　　范围查询，距离（基于LBS）</p> <p>$mod　　  取模运算</p> <p>$near　　　邻域查询，查询附近的位置（基于LBS）</p> <p>$exists　　  字段是否存在</p> <p>$elemMatch　　匹配内数组内的元素</p> <p>$within　　范围查询（基于LBS）</p> <p>$box　　　 范围查询，矩形范围（基于LBS）</p> <p>$center    范围醒询，圆形范围（基于LBS）</p> <p>$centerSphere　　范围查询，球形范围（基于LBS）</p> <p>$slice　　　　查询字段集合中的元素（比如从第几个之后，第N到第M个元素）</p> <p><em>User.find({userage: {$gte: 21, $lte: 65}}, callback);</em></p> <p>//这表示查询年龄大于等21而且小于等于65岁</p> <p>查询所有等于6或者7岁或者8的小朋友</p> <p>model.find({age:{$in:[6,7,8]}},function(err,result));</p> <p>$in 和 $ne 除了条件判断不同，用法很相似。</p> <h3 id="projection-投射"><a href="#projection-投射" class="header-anchor">#</a> projection 投射</h3> <p>参数： «对象|字符串|数组&lt;字符串&gt;»</p> <p>«Object|String|Array<String>»</String></p> <p>optional fields to return, see <a href="https://mongoosejs.com/docs/api/query.html#query_Query-select" target="_blank" rel="noopener noreferrer">Query.prototype.select()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>几个demo：</p> <p>find（conditons，projection ，callback）</p> <p>projection 省略或者为null，查询所有字段。</p> <p>Model.find({},{name:1,age:1,_id:0},function(err,result))</p> <p>返回只包含name,age两个字段的所有记录。</p> <p>1表示查询输出该字段，0表示不输出。</p> <p>默认都会显示 _id，设置为0可以不显示。</p> <p>其他非_id的字段，若设置为0会报错。</p> <p><a href="https://mongoosejs.com/docs/api/query.html#query_Query-select" target="_blank" rel="noopener noreferrer">Query.prototype.select()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>指定<strong>要包含或排除的文档字段</strong>（也称为查询“<strong>投影</strong>”）</p> <p>使用字符串语法时，为路径添加前缀<code>-</code>会将该路径标记为已排除。</p> <p>当路径没有<code>-</code>前缀时，它被包括在内。</p> <p>最后，如果路径以 为前缀<code>+</code>，它会强制包含该路径，这对于在<a href="https://mongoosejs.com/docs/api.html#schematype_SchemaType-select" target="_blank" rel="noopener noreferrer">架构级别<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>排除的路径很有用。</p> <p>投影<em>必须</em>是<strong>包含性的或排除性</strong>的。</p> <p>换句话说，您必须要么列出要包含的字段（排除所有其他字段），要么列出要排除的字段（这意味着包含所有其他字段）。该<a href="https://docs.mongodb.com/manual/tutorial/project-fields-from-query-results/#suppress-id-field" target="_blank" rel="noopener noreferrer"><code>_id</code>字段是唯一的例外，因为 MongoDB 默认包含它<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h4 id="例子"><a href="#例子" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/query.html#example" target="_blank" rel="noopener noreferrer">例子<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>// 只查询a和b字段，其他字段被排除
query.select('a b');

// 等同于下面的语法
query.select(['a', 'b']);
query.select({ a: 1, b: 1 });

// 排除c和d字段，只查询其他字段
query.select('-c -d');

// Use `+` to override schema-level `select: false` without making the
// projection inclusive.
const schema = new Schema({
  foo: { type: String, select: false },
  bar: String
});

// ...
query.select('+foo'); // Override foo's `select: false` without excluding `bar`

// or you may use object notation, useful when
// you have keys already prefixed with a &quot;-&quot;
query.select({ a: 1, b: 1 });
query.select({ c: 0, d: 0 });

Additional calls to select can override the previous selection:
query.select({ a: 1, b: 1 }).select({ b: 0 }); // selection is now { a: 1 }
query.select({ a: 0, b: 0 }).select({ b: 1 }); // selection is now { a: 0 }
</code></pre></div><h3 id="options-6"><a href="#options-6" class="header-anchor">#</a> options</h3> <p>«Object»</p> <p>optional see <a href="https://mongoosejs.com/docs/api/query.html#query_Query-setOptions" target="_blank" rel="noopener noreferrer">Query.prototype.setOptions()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Query.prototype.setOptions()</p> <h5 id="parameters-7"><a href="#parameters-7" class="header-anchor">#</a> Parameters</h5> <ul><li>options «Object»</li></ul> <h5 id="returns-7"><a href="#returns-7" class="header-anchor">#</a> Returns:</h5> <ul><li>«Query» this</li></ul> <p>Sets query options. Some options only make sense for certain operations.</p> <h4 id="options-7"><a href="#options-7" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/query.html#options" target="_blank" rel="noopener noreferrer">Options:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>The following options are only for <code>find()</code>:</p> <ul><li><a href="https://www.mongodb.org/display/DOCS/Tailable+Cursors" target="_blank" rel="noopener noreferrer">tailable<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%7B%7Bsort()%7D%7D" target="_blank" rel="noopener noreferrer">sort<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%7B%7Blimit()%7D%7D" target="_blank" rel="noopener noreferrer">limit<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%7B%7Bskip()%7D%7D" target="_blank" rel="noopener noreferrer">skip<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.mongodb.com/manual/reference/method/cursor.allowDiskUse/" target="_blank" rel="noopener noreferrer">allowDiskUse<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%7B%7BbatchSize()%7D%7D" target="_blank" rel="noopener noreferrer">batchSize<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.mongodb.org/manual/applications/replication/#read-preference" target="_blank" rel="noopener noreferrer">readPreference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24hint" target="_blank" rel="noopener noreferrer">hint<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24comment" target="_blank" rel="noopener noreferrer">comment<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%7B%7Bsnapshot()%7D%7D" target="_blank" rel="noopener noreferrer">snapshot<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.mongodb.org/v3.2/reference/operator/meta/maxScan/#metaOp._S_maxScan" target="_blank" rel="noopener noreferrer">maxscan<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>The following options are only for write operations: <code>update()</code>, <code>updateOne()</code>, <code>updateMany()</code>, <code>replaceOne()</code>, <code>findOneAndUpdate()</code>, and <code>findByIdAndUpdate()</code>:</p> <ul><li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.update/" target="_blank" rel="noopener noreferrer">upsert<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.update/" target="_blank" rel="noopener noreferrer">writeConcern<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://mongoosejs.com/docs/guide.html#timestamps" target="_blank" rel="noopener noreferrer">timestamps<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: If <code>timestamps</code> is set in the schema, set this option to <code>false</code> to skip timestamps for that particular update. Has no effect if <code>timestamps</code> is not enabled in the schema options.</li> <li>overwriteDiscriminatorKey: allow setting the discriminator key in the update. Will use the correct discriminator schema if the update changes the discriminator key.</li></ul> <p>The following options are only for <code>find()</code>, <code>findOne()</code>, <code>findById()</code>, <code>findOneAndUpdate()</code>, and <code>findByIdAndUpdate()</code>:</p> <ul><li><a href="https://mongoosejs.com/docs/api/api.html#query_Query-lean" target="_blank" rel="noopener noreferrer">lean<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://mongoosejs.com/docs/populate.html" target="_blank" rel="noopener noreferrer">populate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://mongoosejs.com/docs/api/query.html#query_Query-projection" target="_blank" rel="noopener noreferrer">projection<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>sanitizeProjection</li></ul> <p>The following options are only for all operations <strong>except</strong> <code>update()</code>, <code>updateOne()</code>, <code>updateMany()</code>, <code>remove()</code>, <code>deleteOne()</code>, and <code>deleteMany()</code>:</p> <ul><li><a href="https://docs.mongodb.com/manual/reference/operator/meta/maxTimeMS/" target="_blank" rel="noopener noreferrer">maxTimeMS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>The following options are for <code>findOneAndUpdate()</code> and <code>findOneAndRemove()</code></p> <ul><li>rawResult</li></ul> <h2 id="the-following-options-are-for-all-operations"><a href="#the-following-options-are-for-all-operations" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/query.html#the-following-options-are-for-all-operations" target="_blank" rel="noopener noreferrer">The following options are for all operations<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <ul><li><a href="https://mongoosejs.com/docs/guide.html#strict" target="_blank" rel="noopener noreferrer">strict<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.mongodb.com/manual/reference/collation/" target="_blank" rel="noopener noreferrer">collation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.mongodb.com/manual/reference/server-sessions/" target="_blank" rel="noopener noreferrer">session<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.mongodb.com/manual/reference/method/cursor.explain/" target="_blank" rel="noopener noreferrer">explain<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="callback"><a href="#callback" class="header-anchor">#</a> callback</h3> <p>«Function»</p> <h4 id="examples-6"><a href="#examples-6" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#examples" target="_blank" rel="noopener noreferrer">Examples:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>// 查询所有文档
await MyModel.find({});

// find all documents named john and at least 18
await MyModel.find({ name: 'john', age: { $gte: 18 } }).exec();

// executes, passing results to callback
MyModel.find({ name: 'john', age: { $gte: 18 }}, function (err, docs) {});

// executes, name LIKE john and only selecting the &quot;name&quot; and &quot;friends&quot; fields
await MyModel.find({ name: /john/i }, 'name friends').exec();

// passing options
await MyModel.find({ name: /john/i }, null, { skip: 10 }).exec();
</code></pre></div><p>聚合查询</p> <p>联表查询 连表查询</p> <h3 id="数量查询"><a href="#数量查询" class="header-anchor">#</a> 数量查询</h3> <p>替换<code>count()</code>为<code>countDocuments()</code>，</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">count</span><span class="token punctuation">(</span>filter<span class="token punctuation">)</span>

<span class="token function">countDocuments</span><span class="token punctuation">(</span>filter<span class="token punctuation">)</span>
</code></pre></div><h3 id="populate关联查询"><a href="#populate关联查询" class="header-anchor">#</a> populate关联查询</h3> <p>populate</p> <p>用于查看关联文档内容, 也就是查询 <strong>设置了</strong> <code>**ref**</code> <strong>的字段</strong> 关联的 文档的 相关字段</p> <p>Model.*<strong>populate*</strong>(docs, options, [cb(err,doc)])</p> <p>例子：</p> <p>// User</p> <div class="language- extra-class"><pre class="language-text"><code>const userSchema = new mongoose.Schema({
    username:{type:String,required:true},
    password:{type:String,required:true},
    email:{type:String,required:true},
  });
 
</code></pre></div><p>// Articel</p> <p>const <em>ObjectId</em> = <em>mongoose</em>.Schema.Types.ObjectId;
const <em>articleSchema</em> = new <em>mongoose</em>.Schema({
title:{type:String,required:true},
content:{type:String,required:true},
create_on:{type:Date,default:Date.now},
user:{type:<em>ObjectId</em>,ref:'User'}
});</p> <p>以上，Article集合的user字段，类型为ObjectId，通过存放User集合中记录的_id字段的值，就关联了User集合。就可以使用populate关联查询到User集合中的数据。</p> <p>//示例</p> <p><em>Article</em>.find({}).populate('user').exec(function(<em>err</em>,<em>result</em>){
console.log(<em>result</em>[0].user); // 此时user成为了一个对象，对应User集合中的一条记录
console.log(<em>result</em>[0].user.username);
console.log(<em>result</em>[0].user.password);</p> <p>});</p> <p>//多个关联表需要使用数组</p> <p>yield Article.findOne({</p> <p>​    _id: id</p> <p>}, {</p> <p>​    title: 1,</p> <p>​    author: 1</p> <p>})</p> <p>.populate([{</p> <p>​    path: 'comments', //文章的comments字段</p> <p>​    select: {</p> <p>​      _id: 1,</p> <p>​      user: 1,</p> <p>​      text: 1,</p> <p>​    },</p> <p>}, {</p> <p>​    path: 'category' //文章的category字段,</p> <p>​    select: {</p> <p>​      fields...</p> <p>​    }</p> <p>}])</p> <h2 id="创建"><a href="#创建" class="header-anchor">#</a> 创建</h2> <ul><li><a href="https://mongoosejs.com/docs/api/model.html#model_Model.create" target="_blank" rel="noopener noreferrer">Model.create()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="model-create"><a href="#model-create" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#model_Model.create" target="_blank" rel="noopener noreferrer">Model.create()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <h5 id="parameters-8"><a href="#parameters-8" class="header-anchor">#</a> Parameters</h5> <ul><li><p>docs</p> <p>«Array|Object»</p> <p>Documents to insert, as a spread or array</p></li> <li><p>[options]</p> <p>«Object»</p> <p>Options passed down tosave(). To specify options, docs must be an array, not a spread.</p></li> <li><p>[callback]</p> <p>«Function»</p> <p>callback</p></li></ul> <h5 id="returns-8"><a href="#returns-8" class="header-anchor">#</a> Returns:</h5> <ul><li>«Promise»</li></ul> <p>Shortcut for saving one or more documents to the database. <code>MyModel.create(docs)</code> does <code>new MyModel(doc).save()</code> for every doc in docs.</p> <p>将一个或多个文档保存到数据库的快捷方式。 <code>MyModel.create(docs)</code>为文档中<code>new MyModel(doc).save()</code>的每个文档做。</p> <p>此函数触发以下中间件。</p> <p>This function triggers the following middleware.</p> <ul><li><code>save()</code></li></ul> <h4 id="example-4"><a href="#example-4" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#example" target="_blank" rel="noopener noreferrer">Example:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>// Insert one new `Character` document
await Character.create({ name: 'Jean-Luc Picard' });

// Insert multiple new `Character` documents
await Character.create([{ name: 'Will Riker' }, { name: 'Geordi LaForge' }]);

// Create a new character within a transaction. Note that you **must**
// pass an array as the first parameter to `create()` if you want to
// specify options.
await Character.create([{ name: 'Jean-Luc Picard' }], { session });
</code></pre></div><h2 id="更新"><a href="#更新" class="header-anchor">#</a> 更新</h2> <p>语法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用doc更新匹配到的第一个文档。已弃用。</span>
<span class="token function">update</span><span class="token punctuation">(</span>filter<span class="token punctuation">,</span> doc<span class="token punctuation">,</span> options<span class="token punctuation">)</span>

<span class="token comment">// 推荐使用</span>
<span class="token comment">// 使用doc更新匹配到的所有文档。不管multi选项的值如何。</span>
<span class="token comment">// updateMany不会触发更新中间件。使用pre('updateMany') andpost('updateMany')代替。</span>
<span class="token function">updateMany</span><span class="token punctuation">(</span>filter<span class="token punctuation">,</span> doc<span class="token punctuation">,</span> options<span class="token punctuation">)</span>

<span class="token comment">// 使用doc更新匹配到的第一个文档。</span>
<span class="token comment">// 不支持multi和overwrite选项。</span>
<span class="token comment">// 好像会触发更新中间件。</span>
<span class="token function">updateOne</span><span class="token punctuation">(</span>filter<span class="token punctuation">,</span> doc<span class="token punctuation">,</span> options<span class="token punctuation">)</span>

<span class="token function">replaceOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><a href="https://mongoosejs.com/docs/api/model.html#model_Model.update" target="_blank" rel="noopener noreferrer">Model.update()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://mongoosejs.com/docs/api/model.html#model_Model.updateMany" target="_blank" rel="noopener noreferrer">Model.updateMany()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://mongoosejs.com/docs/api/model.html#model_Model.updateOne" target="_blank" rel="noopener noreferrer">Model.updateOne()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="删除"><a href="#删除" class="header-anchor">#</a> 删除</h2> <p>替换<code>remove()</code>为<code>deleteOne()</code>或<code>deleteMany()</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 删除符合查询条件的所有文档。若只删除一个，设置options.single为true。</span>
<span class="token comment">// 已弃用。</span>
<span class="token function">remove</span><span class="token punctuation">(</span>filter<span class="token punctuation">,</span> options<span class="token punctuation">)</span>

<span class="token comment">// 删除符合查询条件的第一个文档。返回一个对象，包含一个deleteCount属性，表示删除的文档数量。</span>
<span class="token function">deleteOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 删除符合查询条件的所有文档，返回一个对象，包含一个deleteCount属性，表示删除的文档数量。</span>
<span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><p><a href="https://mongoosejs.com/docs/api/model.html#model_Model.deleteMany" target="_blank" rel="noopener noreferrer">Model.deleteMany()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://mongoosejs.com/docs/api/model.html#model_Model.deleteOne" target="_blank" rel="noopener noreferrer">Model.deleteOne()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://mongoosejs.com/docs/api/model.html#model_Model.remove" target="_blank" rel="noopener noreferrer">Model.remove()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul> <h3 id="model-deletemany"><a href="#model-deletemany" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#model_Model.deleteMany" target="_blank" rel="noopener noreferrer">Model.deleteMany()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <h5 id="parameters-9"><a href="#parameters-9" class="header-anchor">#</a> Parameters</h5> <ul><li><p>conditions «Object»</p></li> <li><p>[options]</p> <p>«Object»</p> <p>optional see</p> <p><code>Query.prototype.setOptions()</code></p></li> <li><p>[callback] «Function»</p></li></ul> <h5 id="returns-9"><a href="#returns-9" class="header-anchor">#</a> Returns:</h5> <ul><li>«Query»</li></ul> <p>Deletes all of the documents that match <code>conditions</code> from the collection. It returns an object with the property <code>deletedCount</code> containing the number of documents deleted. Behaves like <code>remove()</code>, but deletes all documents that match <code>conditions</code> regardless of the <code>single</code> option.</p> <h4 id="example-5"><a href="#example-5" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#example" target="_blank" rel="noopener noreferrer">Example:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>await Character.deleteMany({ name: /Stark/, age: { $gte: 18 } }); // returns {deletedCount: x} where x is the number of documents deleted.
</code></pre></div><h4 id="note-5"><a href="#note-5" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#note" target="_blank" rel="noopener noreferrer">Note:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>This function triggers <code>deleteMany</code> query hooks. Read the <a href="https://mongoosejs.com/docs/middleware.html#naming" target="_blank" rel="noopener noreferrer">middleware docs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to learn more.</p> <hr> <h3 id="model-deleteone"><a href="#model-deleteone" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#model_Model.deleteOne" target="_blank" rel="noopener noreferrer">Model.deleteOne()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <h5 id="parameters-10"><a href="#parameters-10" class="header-anchor">#</a> Parameters</h5> <ul><li><p>conditions «Object»</p></li> <li><p>[options]</p> <p>«Object»</p> <p>optional see</p> <p><code>Query.prototype.setOptions()</code></p></li> <li><p>[callback] «Function»</p></li></ul> <h5 id="returns-10"><a href="#returns-10" class="header-anchor">#</a> Returns:</h5> <ul><li>«Query»</li></ul> <p>Deletes the first document that matches <code>conditions</code> from the collection. It returns an object with the property <code>deletedCount</code> indicating how many documents were deleted. Behaves like <code>remove()</code>, but deletes at most one document regardless of the <code>single</code> option.</p> <h4 id="example-6"><a href="#example-6" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#example" target="_blank" rel="noopener noreferrer">Example:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>await Character.deleteOne({ name: 'Eddard Stark' }); // returns {deletedCount: 1}
</code></pre></div><h4 id="note-6"><a href="#note-6" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/model.html#note" target="_blank" rel="noopener noreferrer">Note:<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>This function triggers <code>deleteOne</code> query hooks. Read the <a href="https://mongoosejs.com/docs/middleware.html#naming" target="_blank" rel="noopener noreferrer">middleware docs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to learn more.</p> <h2 id="分页"><a href="#分页" class="header-anchor">#</a> 分页</h2> <p>分页查询，需要用到两个api，skip和limit。</p> <h3 id="query-prototype-limit"><a href="#query-prototype-limit" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/query.html#query_Query-limit" target="_blank" rel="noopener noreferrer">Query.prototype.limit()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <h5 id="parameters-11"><a href="#parameters-11" class="header-anchor">#</a> Parameters</h5> <ul><li>val «Number»</li></ul> <p>指定查询返回的最大文档数目。即限制查询的条数。</p> <p>Specifies the maximum number of documents the query will return.</p> <h4 id="example-7"><a href="#example-7" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/query.html#example" target="_blank" rel="noopener noreferrer">Example<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>query.limit(20);
</code></pre></div><h4 id="note-7"><a href="#note-7" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/query.html#note" target="_blank" rel="noopener noreferrer">Note<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>Cannot be used with <code>distinct()</code></p> <h3 id="query-prototype-skip"><a href="#query-prototype-skip" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/query.html#query_Query-skip" target="_blank" rel="noopener noreferrer">Query.prototype.skip()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <h5 id="parameters-12"><a href="#parameters-12" class="header-anchor">#</a> Parameters</h5> <ul><li>val «Number»</li></ul> <p>指定略过的文档数目。即略过一定的条数，再进行查询。</p> <p>Specifies the number of documents to skip.</p> <h4 id="example-8"><a href="#example-8" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/query.html#example" target="_blank" rel="noopener noreferrer">Example<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>query.skip(100).limit(20);
</code></pre></div><h4 id="note-8"><a href="#note-8" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/query.html#note" target="_blank" rel="noopener noreferrer">Note<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>Cannot be used with <code>distinct()</code></p> <h2 id="排序"><a href="#排序" class="header-anchor">#</a> 排序</h2> <p>asc：升序</p> <p>desc：降序</p> <p>ascending：</p> <p>descending：</p> <h3 id="query-prototype-sort"><a href="#query-prototype-sort" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/query.html#query_Query-sort" target="_blank" rel="noopener noreferrer">Query.prototype.sort()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <h5 id="parameters-13"><a href="#parameters-13" class="header-anchor">#</a> Parameters</h5> <ul><li>arg «Object|String»</li></ul> <h5 id="returns-11"><a href="#returns-11" class="header-anchor">#</a> Returns:</h5> <ul><li>«Query» this</li></ul> <p>Sets the sort order</p> <p>如果传递的参数是一个对象，值可以设为 <code>asc</code>, <code>desc</code>, <code>ascending</code>, <code>descending</code>, <code>1</code>, and <code>-1</code>。</p> <p>If an object is passed, values allowed are <code>asc</code>, <code>desc</code>, <code>ascending</code>, <code>descending</code>, <code>1</code>, and <code>-1</code>.</p> <p>如果传递的参数是一个字符串，</p> <p>If a string is passed, it must be a space delimited list of path names. The sort order of each path is ascending unless the path name is prefixed with <code>-</code> which will be treated as descending.</p> <h4 id="example-9"><a href="#example-9" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/query.html#example" target="_blank" rel="noopener noreferrer">Example<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <div class="language- extra-class"><pre class="language-text"><code>// sort by &quot;field&quot; ascending and &quot;test&quot; descending
query.sort({ field: 'asc', test: -1 });

// equivalent
query.sort('field -test');
</code></pre></div><h4 id="note-9"><a href="#note-9" class="header-anchor">#</a> <a href="https://mongoosejs.com/docs/api/query.html#note" target="_blank" rel="noopener noreferrer">Note<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>Cannot be used with <code>distinct()</code></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/hsyq/blog/edit/main/docs/mongodb/mongoose的CRUD.md" target="_blank" rel="noopener noreferrer">帮助改善此页面！</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">7/29/2022</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d3443b47.js" defer></script><script src="/assets/js/2.2defd20b.js" defer></script><script src="/assets/js/68.793e626b.js" defer></script>
  </body>
</html>
