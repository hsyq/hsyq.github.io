(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{332:function(t,s,a){"use strict";a.r(s);var e=a(13),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"mongoose"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mongoose"}},[t._v("#")]),t._v(" Mongoose")]),t._v(" "),s("h3",{attrs:{id:"文档采用v6-3-4。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#文档采用v6-3-4。"}},[t._v("#")]),t._v(" 文档采用v6.3.4。")]),t._v(" "),s("p",[t._v("以一个简单的demo，演示如何使用和基本概念。")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" mongoose-learn\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" mongoose-learn\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pnpm")]),t._v(" init\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pnpm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" mongoose\n")])])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" mongoose "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mongoose'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmongoose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mongodb://localhost/test'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Cat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mongoose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("model")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Cat'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" kitty "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Cat")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Zildjian'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nkitty"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'meow'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" mongoose "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mongoose'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 连接到数据库")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 端口号默认为27017可以省略")]),t._v("\nmongoose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mongodb://localhost/book'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 连接到需要认证的数据库")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定user和pass，并通过authSource指定用户属于哪个数据库")]),t._v("\nmongoose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mongodb://admin:123456@localhost/book?authSource=admin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 或者")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 语法：mongoose.connect(uri, options)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// connect 方法也接受 options 参数，这些参数会传入底层 MongoDB 驱动。")]),t._v("\nmongoose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mongodb://localhost'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("user")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'admin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("pass")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'123456'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定要连接的数据库名称（覆盖连接字符串）")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("dbName")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'book'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 非mongoose特有，是mongodb node.js底层驱动的一个选项")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义要进行身份验证的数据库")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("authSource")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'admin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 是否自动建立索引，默认为true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("autoIndex")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// MongoDB保持的最大socket连接数。poolSize 的默认值是 5。")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意，MongoDB 3.4 之前， MongoDB只允许每个 socket 同时进行一个操作，所以如果你有几个缓慢请求卡着后面快的请求，可以尝试增加连接数。")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("poolSize")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在以前，会提示设置 {useUnifiedTopology:true, useNewUrlParser:true}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// https://blog.csdn.net/Jack_lzx/article/details/109564138")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建Schema")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Schema "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mongoose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Schema\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bookSchema "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("required")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("price")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Number"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tags")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Array"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("author")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("required")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("publishDate")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    \n    \n    \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 启用Mongoose自带的时间戳功能，将自动给集合添加两个字段")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("timestamps")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 默认为false")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 修改默认的时间戳字段，不修改则为默认名字")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("createdAt")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'created_time'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("updatedAt")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'updated_time'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建Model")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第一个参数会成为数据库中集合的名字，默认会转为复数形式，当前的BookModel对应的集合名为books")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" BookModel "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mongoose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("model")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Book'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bookSchema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("补充：")]),t._v(" "),s("p",[t._v("authSource：指定在哪个库验证用户。虽然 admin 库下存储所有账号的用户名和密码，但 authSource 参数不一定就是 admin 库。准确地说: 在哪个库下创建用户, authSource 就是那个库。")]),t._v(" "),s("h2",{attrs:{id:"连接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#连接"}},[t._v("#")]),t._v(" 连接")]),t._v(" "),s("h2",{attrs:{id:"schematypes-模式类型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#schematypes-模式类型"}},[t._v("#")]),t._v(" SchemaTypes 模式类型")]),t._v(" "),s("h2",{attrs:{id:"schema的常用属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#schema的常用属性"}},[t._v("#")]),t._v(" Schema的常用属性")]),t._v(" "),s("p",[t._v("mongoose 的所有合法 SchemaTypes：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"http://www.mongoosejs.net/docs/api.html#schema-string-js",target:"_blank",rel:"noopener noreferrer"}},[t._v("String"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"http://www.mongoosejs.net/docs/api.html#schema-number-js",target:"_blank",rel:"noopener noreferrer"}},[t._v("Number"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"http://www.mongoosejs.net/docs/api.html#schema-date-js",target:"_blank",rel:"noopener noreferrer"}},[t._v("Date"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"http://www.mongoosejs.net/docs/api.html#schema-buffer-js",target:"_blank",rel:"noopener noreferrer"}},[t._v("Buffer"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("Boolean")]),t._v(" "),s("li",[t._v("Mixed")]),t._v(" "),s("li",[s("a",{attrs:{href:"http://www.mongoosejs.net/docs/api.html#schema-objectid-js",target:"_blank",rel:"noopener noreferrer"}},[t._v("ObjectId"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("Array")]),t._v(" "),s("li",[t._v("Decimal128")])]),t._v(" "),s("p",[t._v("demo：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" schema "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("    String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("binary")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("  Buffer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("living")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("  Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("updated")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("now "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("age")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Number"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("min")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("max")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("65")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("mixed")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("   Schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Types"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Mixed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("_someId")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Types"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ObjectId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("decimal")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Types"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Decimal128"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义数组类型，形式多种多样")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("array")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("ofString")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("ofNumber")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Number"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("ofDates")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("ofBuffer")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Buffer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("ofBoolean")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("ofMixed")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Types"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Mixed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("ofObjectId")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Types"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ObjectId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("ofArrays")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("ofArrayOfNumbers")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Number"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    \n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("nested")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("stuff")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("lowercase")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("trim")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// example use")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Thing "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mongoose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("model")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Thing'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" m "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thing")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Statue of Liberty'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("125")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("updated "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("binary "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Buffer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("living "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mixed "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("any")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("thing")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'i want'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("markModified")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mixed'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_someId "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("mongoose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Types"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ObjectId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("array"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ofString"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"strings!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ofNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unshift")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ofDates"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addToSet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ofBuffer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pop")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ofMixed "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'three'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("four")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nested"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stuff "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'good'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"schematype-选项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#schematype-选项"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"http://www.mongoosejs.net/docs/schematypes.html#schematype-options",target:"_blank",rel:"noopener noreferrer"}},[t._v("SchemaType 选项"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("给字段设置一些属性。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" schema2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("lowercase")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在存储时将值转为小写字母，仅对string类型有效")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("有一些全部 type 可用的选项和一些限定部分 type 使用的选项。")]),t._v(" "),s("h5",{attrs:{id:"全部可用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#全部可用"}},[t._v("#")]),t._v(" 全部可用")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("required")]),t._v(": 布尔值或函数。如果值为真，为此属性添加 "),s("a",{attrs:{href:"http://www.mongoosejs.net/docs/validation.html#built-in-validators",target:"_blank",rel:"noopener noreferrer"}},[t._v("required 验证器"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("code",[t._v("default")]),t._v(": 任何值或函数。设置此路径默认值。如果是函数，函数返回值为默认值")]),t._v(" "),s("li",[s("code",[t._v("select")]),t._v(": 布尔值。 指定 query 的默认 "),s("a",{attrs:{href:"https://docs.mongodb.com/manual/tutorial/project-fields-from-query-results/",target:"_blank",rel:"noopener noreferrer"}},[t._v("projections"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("code",[t._v("validate")]),t._v(": 函数。 adds a "),s("a",{attrs:{href:"http://www.mongoosejs.net/docs/validation.html#built-in-validators",target:"_blank",rel:"noopener noreferrer"}},[t._v("validator function"),s("OutboundLink")],1),t._v(" for this property")]),t._v(" "),s("li",[s("code",[t._v("get")]),t._v(": 函数。 使用 "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("Object.defineProperty()")]),s("OutboundLink")],1),t._v(" 定义自定义 getter")]),t._v(" "),s("li",[s("code",[t._v("set")]),t._v(": 函数。 使用 "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("Object.defineProperty()")]),s("OutboundLink")],1),t._v(" 定义自定义 setter")]),t._v(" "),s("li",[s("code",[t._v("alias")]),t._v(": 字符串。 仅mongoose >= 4.10.0。 为该字段路径定义"),s("a",{attrs:{href:"http://www.mongoosejs.net/docs/guide.html#virtuals",target:"_blank",rel:"noopener noreferrer"}},[t._v("虚拟值"),s("OutboundLink")],1),t._v(" gets/sets")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" numberSchema "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("integerOnly")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Number"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 取值时，会返回经过get函数处理后的结果")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("v")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" Math"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("round")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置值时，存储经过set函数处理后的结果")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("v")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" Math"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("round")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 猜测，crud时可以通过 i 来代理integerOnly")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("alias")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'i'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Number "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mongoose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("model")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Number'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" numberSchema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" doc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Number")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndoc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("integerOnly "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.001")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndoc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("integerOnly"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2")]),t._v("\ndoc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2")]),t._v("\ndoc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.001")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndoc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("integerOnly"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3")]),t._v("\ndoc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3")]),t._v("\n")])])]),s("h5",{attrs:{id:"索引相关"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#索引相关"}},[t._v("#")]),t._v(" 索引相关")]),t._v(" "),s("p",[t._v("你可以使用 schema type 选项定义"),s("a",{attrs:{href:"https://docs.mongodb.com/manual/indexes/",target:"_blank",rel:"noopener noreferrer"}},[t._v("MongoDB indexes"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("index")]),t._v(": 布尔值。是否对这个属性创建"),s("a",{attrs:{href:"https://docs.mongodb.com/manual/indexes/",target:"_blank",rel:"noopener noreferrer"}},[t._v("索引"),s("OutboundLink")],1),t._v("   可以设为其他值吗，比如1，表示按升序，0表示按降序。")]),t._v(" "),s("li",[s("code",[t._v("unique")]),t._v(": 布尔值。是否对这个属性创建"),s("a",{attrs:{href:"https://docs.mongodb.com/manual/core/index-unique/",target:"_blank",rel:"noopener noreferrer"}},[t._v("唯一索引"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("code",[t._v("sparse")]),t._v(": 布尔值。是否对这个属性创建"),s("a",{attrs:{href:"https://docs.mongodb.com/manual/core/index-sparse/",target:"_blank",rel:"noopener noreferrer"}},[t._v("稀疏索引"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" schema2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("index")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将test字段设为索引")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 唯一性索引")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定为唯一性索引后，该字段不能插入重复的值，会报错。")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果一个字段已经有重复值了，再指定为唯一性索引，也会报错。")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("unique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Unique index. If you specify `unique: true`")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果指定“unique：true”，则指定“index:true”是可选的")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// specifying `index: true` is optional if you do `unique: true`")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("一个猜测：")]),t._v(" "),s("p",[t._v("索引本身就具备唯一性。")]),t._v(" "),s("p",[t._v("MongoDB默认将_id设为索引。")]),t._v(" "),s("p",[t._v("设为索引的特点就是值得是唯一的？")]),t._v(" "),s("p",[t._v("unique是可独立设置给一个字段的。")]),t._v(" "),s("p",[t._v("test字段的值是唯一的。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" schema2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("unique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("test字段的值是唯一性索引，既是索引，又得是唯一值。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" schema2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("index")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("unique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h5",{attrs:{id:"string"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#string"}},[t._v("#")]),t._v(" String")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("lowercase")]),t._v(": 布尔值。是否在保存前对此值调用 "),s("code",[t._v(".toLowerCase()")])]),t._v(" "),s("li",[s("code",[t._v("uppercase")]),t._v(": 布尔值。 是否在保存前对此值调用 "),s("code",[t._v(".toUpperCase()")])]),t._v(" "),s("li",[s("code",[t._v("trim")]),t._v(": 布尔值。 是否在保存前对此值调用 "),s("code",[t._v(".trim()")])]),t._v(" "),s("li",[s("code",[t._v("match")]),t._v(": 正则表达式。 创建"),s("a",{attrs:{href:"http://www.mongoosejs.net/docs/validation.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("验证器"),s("OutboundLink")],1),t._v("检查这个值是否匹配给定正则表达式")]),t._v(" "),s("li",[s("code",[t._v("enum")]),t._v(": 数组。 创建"),s("a",{attrs:{href:"http://www.mongoosejs.net/docs/validation.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("验证器"),s("OutboundLink")],1),t._v("检查这个值是否包含于给定数组")])]),t._v(" "),s("h5",{attrs:{id:"number"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#number"}},[t._v("#")]),t._v(" Number")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("min")]),t._v(": 数值。 创建"),s("a",{attrs:{href:"http://www.mongoosejs.net/docs/validation.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("验证器"),s("OutboundLink")],1),t._v("检查属性是否大于或等于该值")]),t._v(" "),s("li",[s("code",[t._v("max")]),t._v(": 数值。 创建"),s("a",{attrs:{href:"http://www.mongoosejs.net/docs/validation.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("验证器"),s("OutboundLink")],1),t._v("检查属性是否小于或等于该值")])]),t._v(" "),s("h5",{attrs:{id:"date"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#date"}},[t._v("#")]),t._v(" Date")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("min")]),t._v(": Date")]),t._v(" "),s("li",[s("code",[t._v("max")]),t._v(": Date")])]),t._v(" "),s("h3",{attrs:{id:"使用注意"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用注意"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"http://www.mongoosejs.net/docs/schematypes.html#usage-notes",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用注意"),s("OutboundLink")],1)]),t._v(" "),s("h4",{attrs:{id:"dates"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dates"}},[t._v("#")]),t._v(" Dates")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date",target:"_blank",rel:"noopener noreferrer"}},[t._v("内建 "),s("code",[t._v("Date")]),t._v(" 方法"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/Automattic/mongoose/issues/1598",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("不会")]),t._v("触发"),s("OutboundLink")],1),t._v(" mongoose 修改跟踪逻辑， 如果你对使用 "),s("code",[t._v("setMonth()")]),t._v(" 修改文档里的 "),s("code",[t._v("Date")]),t._v("， mongoose在 "),s("code",[t._v("doc.save()")]),t._v(" 的时候是察觉不到这个文档发生了变化的，因此保存不到数据库。 如果你一定要用内建 "),s("code",[t._v("Date")]),t._v(" 方法， 请手动调用 "),s("code",[t._v("doc.markModified('pathToYourDate')")]),t._v(" 告诉 mongoose 你修改了数据。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Assignment "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mongoose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("model")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Assignment'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("dueDate")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Date "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nAssignment"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findOne")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" doc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  doc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dueDate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setMonth")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  doc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// THIS DOES NOT SAVE YOUR CHANGE")]),t._v("\n\n  doc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("markModified")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dueDate'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  doc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// works")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"mixed"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mixed"}},[t._v("#")]),t._v(" Mixed")]),t._v(" "),s("p",[t._v("一个啥都可以放的 SchemaType ， 虽然便利，但也会让数据难以维护。 Mixed 可以通过 Schema.Types.Mixed 或 传入一个空对象定义。以下三种方法效果一致：")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Any "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("any")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Any "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("any")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Object "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Any "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("any")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Types"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Mixed "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("因为这是个 schema-less type， 所以你可以赋值为任意类型， 但是 mongoose 无法自动检测并保存你的修改。 要告诉 Mongoose 你修改了 Mixed type 的值，调用 文档的 "),s("code",[t._v(".markModified(path)")]),t._v(" 方法， 传入你的 Mixed 字段路径。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("person"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("anything "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("x")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("y")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"changed"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nperson"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("markModified")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'anything'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nperson"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// anything will now get saved")]),t._v("\n")])])]),s("h4",{attrs:{id:"objectids"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#objectids"}},[t._v("#")]),t._v(" ObjectIds")]),t._v(" "),s("p",[t._v("要指定类型为 ObjectId，在声明中使用 "),s("code",[t._v("Schema.Types.ObjectId")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" mongoose "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mongoose'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ObjectId "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mongoose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Types"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ObjectId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Car "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("driver")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ObjectId "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// or just Schema.ObjectId for backwards compatibility with v2")]),t._v("\n")])])]),s("h4",{attrs:{id:"arrays"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#arrays"}},[t._v("#")]),t._v(" Arrays")]),t._v(" "),s("p",[t._v("创造 "),s("a",{attrs:{href:"http://www.mongoosejs.net/docs/api.html#schema_Schema.Types",target:"_blank",rel:"noopener noreferrer"}},[t._v("SchemaTypes"),s("OutboundLink")],1),t._v(" 或"),s("a",{attrs:{href:"http://www.mongoosejs.net/docs/subdocs.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("子文档"),s("OutboundLink")],1),t._v("数组。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ToySchema "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ToyBox "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("toys")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ToySchema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("buffers")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Buffer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("numbers")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Number"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ... etc")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("注意：指定空数组相当于 "),s("code",[t._v("Mixed")]),t._v("。以下操作相当于创建 "),s("code",[t._v("Mixed")]),t._v(" 数组：")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Empty1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("any")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Empty2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("any")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Array "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Empty3 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("any")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Types"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Mixed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Empty4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("any")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("数组的默认值是 "),s("code",[t._v("[]")]),t._v(" （空数组）。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Toy "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mongoose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("model")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Test'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ToySchema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Toy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("toys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// []")]),t._v("\n")])])]),s("p",[t._v("要手动把默认值设置为 "),s("code",[t._v("undefined")]),t._v("，从而覆盖 "),s("code",[t._v("[]")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ToySchema "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("toys")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ToySchema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"创建自定义-type"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建自定义-type"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"http://www.mongoosejs.net/docs/schematypes.html#customtypes",target:"_blank",rel:"noopener noreferrer"}},[t._v("创建自定义 Type"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("Mongoose 可以扩展自定义 SchemaTypes。搜索 "),s("a",{attrs:{href:"http://plugins.mongoosejs.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("插件"),s("OutboundLink")],1),t._v(" 页面，查找类似"),s("a",{attrs:{href:"https://github.com/aheckmann/mongoose-long",target:"_blank",rel:"noopener noreferrer"}},[t._v("mongoose-long"),s("OutboundLink")],1),t._v(", "),s("a",{attrs:{href:"https://github.com/vkarpov15/mongoose-int32",target:"_blank",rel:"noopener noreferrer"}},[t._v("mongoose-int32"),s("OutboundLink")],1),t._v("， "),s("a",{attrs:{href:"https://github.com/aheckmann/mongoose-function",target:"_blank",rel:"noopener noreferrer"}},[t._v("以及其他"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/OpenifyIt/mongoose-types",target:"_blank",rel:"noopener noreferrer"}},[t._v("types"),s("OutboundLink")],1),t._v(" 的兼容 types。")]),t._v(" "),s("h3",{attrs:{id:"schema-path-函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#schema-path-函数"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"http://www.mongoosejs.net/docs/schematypes.html#path",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("schema.path()")]),t._v(" 函数"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("code",[t._v("schema.path()")]),t._v(" 函数为给定字段路径返回实例化 schema type。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" sampleSchema "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("required")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sampleSchema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'name'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Output looks like:")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * SchemaString {\n *   enumValues: [],\n *   regExp: null,\n *   path: 'name',\n *   instance: 'String',\n *   validators: ...\n */")]),t._v("\n")])])]),s("p",[t._v("这个函数可以检查给定字段路径的检验器和类型等信息。")]),t._v(" "),s("h3",{attrs:{id:"下一步"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下一步"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"http://www.mongoosejs.net/docs/schematypes.html#next",target:"_blank",rel:"noopener noreferrer"}},[t._v("下一步"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("这章我们介绍了 "),s("code",[t._v("SchemaTypes")]),t._v("，下一个章节将会介绍 "),s("a",{attrs:{href:"http://www.mongoosejs.net/docs/connections.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Connections"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("h2",{attrs:{id:"插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#插件"}},[t._v("#")]),t._v(" 插件")]),t._v(" "),s("p",[t._v("http://www.mongoosejs.net/docs/plugins.html")]),t._v(" "),s("p",[t._v("用来扩展Scheme的功能。")]),t._v(" "),s("p",[t._v("编写好插件，可以用于特定的Schema，或者使用mongoose全局注册，作用于所有的Schema。")]),t._v(" "),s("h2",{attrs:{id:"model的api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#model的api"}},[t._v("#")]),t._v(" Model的API")]),t._v(" "),s("p",[t._v("Model是一个类，")]),t._v(" "),s("p",[t._v("类有实例方法/原型方法，也有静态方法。")]),t._v(" "),s("p",[t._v("实体的方法：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.aggregate",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.aggregate()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.buildBulkWriteOperations",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.buildBulkWriteOperations()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.bulkSave",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.bulkSave()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.bulkWrite",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.bulkWrite()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.cleanIndexes",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.cleanIndexes()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.count",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.count()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.countDocuments",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.countDocuments()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.create",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.create()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.createCollection",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.createCollection()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.createIndexes",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.createIndexes()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.deleteMany",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.deleteMany()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.deleteOne",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.deleteOne()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.diffIndexes",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.diffIndexes()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.discriminator",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.discriminator()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.distinct",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.distinct()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.ensureIndexes",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.ensureIndexes()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.estimatedDocumentCount",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.estimatedDocumentCount()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model-events",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.events"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.exists",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.exists()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.find",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.find()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.findById",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.findById()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.findByIdAndDelete",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.findByIdAndDelete()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.findByIdAndRemove",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.findByIdAndRemove()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.findByIdAndUpdate",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.findByIdAndUpdate()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.findOne",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.findOne()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.findOneAndDelete",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.findOneAndDelete()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.findOneAndRemove",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.findOneAndRemove()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.findOneAndReplace",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.findOneAndReplace()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.findOneAndUpdate",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.findOneAndUpdate()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.hydrate",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.hydrate()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.init",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.init()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.insertMany",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.insertMany()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.inspect",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.inspect()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.listIndexes",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.listIndexes()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.mapReduce",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.mapReduce()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.populate",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.populate()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model-$where",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.prototype.$where"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model-$where",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.prototype.$where()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model-base",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.prototype.base"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model-baseModelName",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.prototype.baseModelName"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model-collection",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.prototype.collection"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model-db",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.prototype.db"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model-deleteOne",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.prototype.deleteOne()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model-discriminators",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.prototype.discriminators"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model-model",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.prototype.model()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model-modelName",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.prototype.modelName"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model-remove",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.prototype.remove()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model-save",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.prototype.save()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model-schema",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.prototype.schema"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.remove",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.remove()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.replaceOne",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.replaceOne()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.startSession",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.startSession()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.syncIndexes",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.syncIndexes()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.translateAliases",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.translateAliases()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.update",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.update()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.updateMany",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.updateMany()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.updateOne",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.updateOne()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.validate",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.validate()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.watch",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.watch()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#model_Model.where",target:"_blank",rel:"noopener noreferrer"}},[t._v("Model.where()"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("[function Object() { "),s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#$model_$model",target:"_blank",rel:"noopener noreferrer"}},[t._v("native code] }.prototype.$model()"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mongoosejs.com/docs/api/model.html#increment_increment",target:"_blank",rel:"noopener noreferrer"}},[t._v("increment()"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("模型的方法：")]),t._v(" "),s("p",[t._v("这个用的多。")]),t._v(" "),s("p",[t._v("find")]),t._v(" "),s("h1",{attrs:{id:"mongoose的弃用通知"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mongoose的弃用通知"}},[t._v("#")]),t._v(" Mongoose的弃用通知")]),t._v(" "),s("p",[t._v("https://mongoosejs.com/docs/deprecations.html")]),t._v(" "),s("h1",{attrs:{id:"弃用警告"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#弃用警告"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://mongoosejs.com/docs/deprecations.html#deprecation-warnings",target:"_blank",rel:"noopener noreferrer"}},[t._v("弃用警告"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("Mongoose 用户应该注意"),s("a",{attrs:{href:"http://npmjs.com/package/mongodb",target:"_blank",rel:"noopener noreferrer"}},[t._v("MongoDB Node.js 驱动程序"),s("OutboundLink")],1),t._v("中有几个弃用的地方。Mongoose 提供了解决这些弃用警告的选项，但您需要测试这些选项是否会给您的应用程序带来任何问题。请"),s("a",{attrs:{href:"https://github.com/Automattic/mongoose/issues/new",target:"_blank",rel:"noopener noreferrer"}},[t._v("在 GitHub 上报告任何问题"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("h2",{attrs:{id:"概括"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概括"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://mongoosejs.com/docs/deprecations.html#summary",target:"_blank",rel:"noopener noreferrer"}},[t._v("概括"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("要修复所有弃用警告，请按照以下步骤操作：")]),t._v(" "),s("ul",[s("li",[t._v("替换"),s("code",[t._v("update()")]),t._v("为"),s("code",[t._v("updateOne()")]),t._v(", "),s("code",[t._v("updateMany()")]),t._v(", 或"),s("code",[t._v("replaceOne()")])]),t._v(" "),s("li",[t._v("替换"),s("code",[t._v("remove()")]),t._v("为"),s("code",[t._v("deleteOne()")]),t._v("或"),s("code",[t._v("deleteMany()")]),t._v("。")]),t._v(" "),s("li",[t._v("替换"),s("code",[t._v("count()")]),t._v("为"),s("code",[t._v("countDocuments()")]),t._v("，除非您想计算整个集合中有多少文档（无过滤器）。在后一种情况下，使用"),s("code",[t._v("estimatedDocumentCount()")]),t._v(".")])]),t._v(" "),s("p",[t._v("请阅读以下内容以获取有关每个弃用警告的更详细说明。")]),t._v(" "),s("h2",{attrs:{id:"remove"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#remove"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://mongoosejs.com/docs/deprecations.html#remove",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("remove()")]),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("MongoDB 驱动程序的"),s("a",{attrs:{href:"http://mongodb.github.io/node-mongodb-native/3.1/api/Collection.html#remove",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("remove()")]),t._v("函数"),s("OutboundLink")],1),t._v("已被弃用，取而代之的是"),s("code",[t._v("deleteOne()")]),t._v("和"),s("code",[t._v("deleteMany()")]),t._v("。这是为了遵守"),s("a",{attrs:{href:"https://github.com/mongodb/specifications/blob/master/source/crud/crud.rst",target:"_blank",rel:"noopener noreferrer"}},[t._v("MongoDB CRUD 规范"),s("OutboundLink")],1),t._v("，该规范旨在为所有 MongoDB 驱动程序的 CRUD 操作提供一致的 API。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("DeprecationWarning: collection.remove is deprecated. Use deleteOne,\ndeleteMany, or bulkWrite instead.\n")])])]),s("p",[t._v("要删除此弃用警告，请将 的任何用法替换为"),s("code",[t._v("remove()")]),t._v("， "),s("code",[t._v("deleteMany()")]),t._v("除非"),s("em",[t._v("您")]),t._v("将"),s("a",{attrs:{href:"https://mongoosejs.com/docs/api.html#model_Model.remove",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("single")]),t._v("选项指定为"),s("code",[t._v("remove()")]),s("OutboundLink")],1),t._v("。该"),s("code",[t._v("single")]),t._v(" 选项仅限"),s("code",[t._v("remove()")]),t._v("于删除最多一个文档，因此您应该替换"),s("code",[t._v("remove(filter, { single: true })")]),t._v("为"),s("code",[t._v("deleteOne(filter)")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Replace this:")]),t._v("\nMyModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("foo")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bar'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// With this:")]),t._v("\nMyModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("deleteMany")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("foo")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bar'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Replace this:")]),t._v("\nMyModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("answer")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("single")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// With this:")]),t._v("\nMyModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("deleteOne")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("answer")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"update"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#update"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://mongoosejs.com/docs/deprecations.html#update",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("update()")]),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("与 一样"),s("code",[t._v("remove()")]),t._v("，该"),s("a",{attrs:{href:"https://mongoosejs.com/docs/api.html#model_Model.update",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("update()")]),t._v("函数"),s("OutboundLink")],1),t._v("已被弃用，取而代之的是更明确"),s("a",{attrs:{href:"https://mongoosejs.com/docs/api.html#model_Model.updateOne",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("updateOne()")]),s("OutboundLink")],1),t._v("的"),s("a",{attrs:{href:"https://mongoosejs.com/docs/api.html#model_Model.updateMany",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("updateMany()")]),s("OutboundLink")],1),t._v("、 和"),s("a",{attrs:{href:"https://mongoosejs.com/docs/api.html#model_Model.replaceOne",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("replaceOne()")]),s("OutboundLink")],1),t._v("函数。您应该替换 "),s("code",[t._v("update()")]),t._v("为"),s("code",[t._v("updateOne()")]),t._v("，除非您使用"),s("a",{attrs:{href:"https://mongoosejs.com/docs/api.html#model_Model.update",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("multi")]),t._v("or"),s("code",[t._v("overwrite")]),t._v("选项"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("collection.update is deprecated. Use updateOne, updateMany, or bulkWrite\ninstead.\n// Replace this:\nMyModel.update({ foo: 'bar' }, { answer: 42 });\n// With this:\nMyModel.updateOne({ foo: 'bar' }, { answer: 42 });\n\n// If you use `overwrite: true`, you should use `replaceOne()` instead:\nMyModel.update(filter, update, { overwrite: true });\n// Replace with this:\nMyModel.replaceOne(filter, update);\n\n// If you use `multi: true`, you should use `updateMany()` instead:\nMyModel.update(filter, update, { multi: true });\n// Replace with this:\nMyModel.updateMany(filter, update);\n")])])]),s("h2",{attrs:{id:"count"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#count"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://mongoosejs.com/docs/deprecations.html#count",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("count()")]),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("MongoDB 服务器已弃用该"),s("code",[t._v("count()")]),t._v("函数，取而代之的是两个单独的函数，"),s("a",{attrs:{href:"https://mongoosejs.com/docs/deprecations.html#query_Query-countDocuments",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("countDocuments()")]),s("OutboundLink")],1),t._v("以及 "),s("a",{attrs:{href:"https://mongoosejs.com/docs/deprecations.html#query_Query-estimatedDocumentCount",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("estimatedDocumentCount()")]),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("DeprecationWarning: collection.count is deprecated, and will be removed in a future version. Use collection.countDocuments or collection.estimatedDocumentCount instead\n")])])]),s("p",[t._v("两者的区别在于"),s("code",[t._v("countDocuments()")]),t._v("可以接受一个过滤器参数，比如"),s("a",{attrs:{href:"https://mongoosejs.com/docs/deprecations.html#query_Query-find",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("find()")]),s("OutboundLink")],1),t._v(". 该"),s("code",[t._v("estimatedDocumentCount()")]),t._v(" 函数速度更快，但只能告诉您集合中的文档总数。您不能将 a 传递"),s("code",[t._v("filter")]),t._v("给"),s("code",[t._v("estimatedDocumentCount()")]),t._v("。")]),t._v(" "),s("p",[t._v("要迁移，请替换"),s("code",[t._v("count()")]),t._v("为，"),s("code",[t._v("countDocuments()")]),t._v(" "),s("em",[t._v("除非")]),t._v("您没有将任何参数传递给"),s("code",[t._v("count()")]),t._v(". 如果您使用"),s("code",[t._v("count()")]),t._v("计数集合中的所有文档而不是计数匹配查询的文档，请使用 "),s("code",[t._v("estimatedDocumentCount()")]),t._v("代替"),s("code",[t._v("countDocuments()")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Replace this:")]),t._v("\nMyModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("answer")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// With this:")]),t._v("\nMyModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("countDocuments")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("answer")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// If you're counting all documents in the collection, use")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// `estimatedDocumentCount()` instead.")]),t._v("\nMyModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Replace with:")]),t._v("\nMyModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("estimatedDocumentCount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Replace this:")]),t._v("\nMyModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("answer")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// With this:")]),t._v("\nMyModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("answer")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("countDocuments")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Replace this:")]),t._v("\nMyModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// With this, since there's no filter")]),t._v("\nMyModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("estimatedDocumentCount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);